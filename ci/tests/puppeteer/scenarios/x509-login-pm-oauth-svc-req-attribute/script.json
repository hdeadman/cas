{
  "dependencies": "x509,x509-core,x509-webflow,saml-idp,rest-x509,ldap,person-directory,oidc,pm,pm-ldap,pm-webflow,aup-webflow,oauth-webflow,json-service-registry,authy",
  "properties": [
    "--cas.service-registry.core.init-from-json=true",
    "--cas.service-registry.json.location=file:${PWD}/ci/tests/puppeteer/scenarios/${SCENARIO}/services",
    "--cas.acceptable-usage-policy.core.enabled=false",

    "--cas.webflow.flowDebugEnabled=true",
    "--cas.webflow.flowExecutionCountMax=5",

    "--cas.authn.saml-idp.core.entity-id=https://cas.apereo.org/saml/idp/%{random}",
    "--cas.authn.saml-idp.core.authentication-context-class-mappings=https://refeds.org/profile/mfa->mfa-gauth",
    "--cas.authn.saml-idp.metadata.file-system.location=file:${PWD}/ci/tests/puppeteer/scenarios/${SCENARIO}/saml-md",

    "--server.ssl.trust-store=file:${PWD}/ci/tests/puppeteer/scenarios/${SCENARIO}/truststore.jks",
    "--server.ssl.trust-store-password=changeit",
    "--server.ssl.key-store-type=PKCS12",
    "--server.ssl.client-auth=want",

    "--logging.level.org.apereo.cas=debug",
    "--logging.level.org.apereo.services.persondir=trace",
    "--logging.level.org.apereo.cas.persondir=trace",
    "--logging.level.org.apereo.cas.authentication.principal.cache=trace",

    "--cas.authn.accept.enabled=false",

    "--cas.authn.oauth.user-profile-view-type=FLAT",
    "--cas.authn.oidc.core.issuer=https://localhost:8443/cas/oidc",
    "--cas.authn.oidc.jwks.jwks-file=file:${PWD}/ci/tests/puppeteer/scenarios/${SCENARIO}/keystore.jwks",

    "--cas.person-directory.active-attribute-repository-ids=COMMONATTRS,ADAUTH",

    "--cas.authn.x509.principal.active-attribute-repository-ids=COMMONATTRS,ADCERT",
    "--cas.authn.x509.reg-ex-trusted-issuer-dn-pattern=.*",
    "--cas.authn.x509.max-path-length-allow-unspecified=true",
    "--cas.authn.x509.principal-type=RFC822_EMAIL",
    "--cas.authn.x509.principal.principal-attribute=x509Rfc822Email,subjectDn",
    "--cas.authn.x509.subject-alt-name.alternate-principal-attribute=subjectDn",

    "--cas.authn.attribute-repository.core.aggregation=CASCADE",
    "--cas.authn.attribute-repository.core.merger=MULTIVALUED",
    "--cas.authn.attribute-repository.core.default-attributes-to-release=allowedaccess,someattribute,anotherattribute,ldap-dn,uid,user-account-control,x509Rfc822Email,x509subjectUPN",


    "--cas.authn.ldap[0].passwordPolicy.type=AD",
    "--cas.authn.ldap[0].passwordPolicy.enabled=true",
    "--cas.authn.ldap[0].passwordPolicy.warning-days=1",

    "--cas.authn.pm.core.enabled=true",
    "--cas.authn.pm.core.policy-pattern=^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[$@^$!#%*?&()])[A-Za-z\\d$@^$!#%*?&()]{16,256}",
    "--cas.authn.pm.ldap[0].type=AD",
    "--cas.authn.pm.ldap[0].username-attribute=sAMAccountName",
    "--cas.authn.pm.ldap[0].ldap-url=ldap://localhost:10390",
    "--cas.authn.pm.ldap[0].use-start-tls=${profile.ldap.use-start-tls:false}",
    "--cas.authn.pm.ldap[0].trust-store=file:/tmp/adcacerts.jks",
    "--cas.authn.pm.ldap[0].trust-store-password=changeit",
    "--cas.authn.pm.ldap[0].trust-store-type=JKS",
    "--cas.authn.pm.ldap[0].hostname-verifier=ANY",
    "--cas.authn.pm.ldap[0].base-dn=dc=cas,dc=example,dc=org",
    "--cas.authn.pm.ldap[0].search-filter=(sAMAccountName={user})",
    "--cas.authn.pm.ldap[0].subtree-search=true",
    "--cas.authn.pm.ldap[0].bind-dn=Administrator@cas.example.org",
    "--cas.authn.pm.ldap[0].bind-credential=M3110nM3110n#1",
    "--cas.authn.pm.ldap[0].min-pool-size=0",
    "--cas.authn.pm.ldap[0].max-pool-size=5",
    "--cas.authn.pm.ldap[0].validate-on-checkout=true",

    "--cas.authn.ldap[0].base-dn=dc=cas,dc=example,dc=org",
    "--cas.authn.ldap[0].bind-credential=M3110nM3110n#1",
    "--cas.authn.ldap[0].bind-dn=Administrator@cas.example.org",
    "--cas.authn.ldap[0].ldap-url=ldap://localhost:10390",
    "--cas.authn.ldap[0].max-pool-size=5",
    "--cas.authn.ldap[0].min-pool-size=0",
    "--cas.authn.ldap[0].subtree-search=true",
    "--cas.authn.ldap[0].type=AUTHENTICATED",
    "--cas.authn.ldap[0].search-filter=(sAMAccountName={user})",
    "--cas.authn.ldap[0].use-start-tls=false",
    "--cas.authn.ldap[0].trust-store=JKS",
    "--cas.authn.ldap[0].trust-store-password=changeit",
    "--cas.authn.ldap[0].trust-store-type=JKS",
    "--cas.authn.ldap[0].hostname-verifier=ANY",

    "--cas.authn.attribute-repository.ldap[0].id=ADAUTH",
    "--cas.authn.attribute-repository.ldap[0].order=0",
    "--cas.authn.attribute-repository.ldap[0].attributes.sAMAccountName=uid",
    "--cas.authn.attribute-repository.ldap[0].attributes.userAccountControl=user-account-control",
    "--cas.authn.attribute-repository.ldap[0].attributes.distinguishedName=ldap-dn",
    "--cas.authn.attribute-repository.ldap[0].bind-dn=Administrator@cas.example.org",
    "--cas.authn.attribute-repository.ldap[0].bind-credential=M3110nM3110n#1",
    "--cas.authn.attribute-repository.ldap[0].ldap-url=ldap://localhost:10390",
    "--cas.authn.attribute-repository.ldap[0].use-start-tls=false",
    "--cas.authn.attribute-repository.ldap[0].subtree-search=true",
    "--cas.authn.attribute-repository.ldap[0].base-dn=dc=cas,dc=example,dc=org",
    "--cas.authn.attribute-repository.ldap[0].follow-referrals=false",
    "--cas.authn.attribute-repository.ldap[0].search-filter=(sAMAccountName={username})",
    "--cas.authn.attribute-repository.ldap[0].min-pool-size=0",
    "--cas.authn.attribute-repository.ldap[0].trust-store=file:/tmp/adcacerts.jks",
    "--cas.authn.attribute-repository.ldap[0].trust-store-type=JKS",
    "--cas.authn.attribute-repository.ldap[0].trust-store-password=changeit",
    "--cas.authn.attribute-repository.ldap[0].hostname-verifier=ANY",

    "--cas.authn.attribute-repository.ldap[1].id=ADCERT",
    "--cas.authn.attribute-repository.ldap[1].order=1",
    "--cas.authn.attribute-repository.ldap[1].attributes.sAMAccountName=uid",
    "--cas.authn.attribute-repository.ldap[1].attributes.userAccountControl=user-account-control",
    "--cas.authn.attribute-repository.ldap[1].attributes.distinguishedName=ldap-dn",
    "--cas.authn.attribute-repository.ldap[1].bind-dn=Administrator@cas.example.org",
    "--cas.authn.attribute-repository.ldap[1].bind-credential=M3110nM3110n#1",
    "--cas.authn.attribute-repository.ldap[1].ldap-url=ldap://localhost:10390",
    "--cas.authn.attribute-repository.ldap[1].use-start-tls=false",
    "--cas.authn.attribute-repository.ldap[1].subtree-search=true",
    "--cas.authn.attribute-repository.ldap[1].base-dn=dc=cas,dc=example,dc=org",
    "--cas.authn.attribute-repository.ldap[1].follow-referrals=false",
    "--cas.authn.attribute-repository.ldap[1].search-filter=(mail={x509Rfc822Email})",
    "--cas.authn.attribute-repository.ldap[1].min-pool-size=0",
    "--cas.authn.attribute-repository.ldap[1].trust-store=file:/tmp/adcacerts.jks",
    "--cas.authn.attribute-repository.ldap[1].trust-store-type=JKS",
    "--cas.authn.attribute-repository.ldap[1].trust-store-password=changeit",
    "--cas.authn.attribute-repository.ldap[1].hostname-verifier=ANY",

    "--cas.authn.attribute-repository.groovy[0].id=COMMONATTRS",
    "--cas.authn.attribute-repository.groovy[0].location=file:${PWD}/ci/tests/puppeteer/scenarios/${SCENARIO}/attributes.groovy",
    "--cas.authn.attribute-repository.groovy[0].order=2",
    "--cas.authn.attribute-repository.groovy[0].case-insensitive=false"
  ],
  "trustStoreCertificateFile": "./ci/tests/puppeteer/scenarios/x509-login-pm-oauth-svc-req-attribute/cert.pem",
  "trustStorePrivateKeyFile": "./ci/tests/puppeteer/scenarios/x509-login-pm-oauth-svc-req-attribute/key.pem",
  "initScript": "${PWD}/ci/tests/ldap/run-ad-server.sh"
}
